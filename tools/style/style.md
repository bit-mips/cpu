# 代码规范

## 代码的对齐和缩进

使用Tab进行缩进，即对于不同的层次需要不同数量的Tab

使用空格进行对齐，即对于不同行之间的注释之类的代码让其出现在同一位置

## module的定义

### module名称

一个文件中仅能定义一个`module`，其命名规则需要以`CPU_RegFile`，其中下划线前代表该文件从属的大模块，下划线后为描述性的名称，单词首字母大写

### module接口定义

每个接口占一行，包括输入输出属性和类型等属性，并且对齐，接口名字需要使用描述性名称，均为小写，以下划线分隔单词

## 运算符的使用

### 单目运算符
与操作数间没有间隔

### 双目运算符、三目运算符
与前后操作数间为一个间隔

## 括号的使用
括号紧跟离其最近的内部单词，无需间隔

## begin end的用法
begin和前一语句在一行，间隔一个空格，end单独在一行



# To Be Discuss

## 不允许在代码中出现的语句要点

任何变量不能赋初始值X，对任何寄存器所赋的初始值必须是确定的。

代码语句中不能加时间延迟，不允许出现如下语句: #4 out=cin

不允许使用门控时钟和门控复位

不允许使用锁存器。(商用综合器可帮助执行这项规范,如使用了锁存器,综合结果会出现Latch inferred)。

不允许在可综合的设计代码中使用\`Define来定义参数，应该使用参数Parameter来定义。\`Define只用于编写不可综合的仿真测试模块。

不允许在可综合代码中使用initial、wait、fork-join、while

不允许使用UDP(用户定义的原语元件)

不允许在可综合代码中出现逻辑反馈环路，否则会生成不可预知的逻辑电路

不允许在可综合模块中使用case，casez语句，只允许使用case和if-else语句作条件分支语句。

在时序逻辑的设计中不允许用阻塞赋值=，只允许用非阻塞赋值<=。

在组合逻辑的设计中而不允许使用非阻塞赋值<=，只允许用阻塞赋值=。

## 建议尽量采用的要点

用高电平有效的硬件异步复位reset

用高电平有效的同步软件复位reset.。

尽可能使用高电平有效信号，不使用低电平有效信号(除某些总线、器件有特殊要求外)。只有复位信号reset在特定情况下可以设置为低电平有效信号。

尽可能使用assign语句设计组合逻辑。

模块之间数据交换总线应该尽量用多路器实现。尽量不使用三态总线。三态总线只用于对外接口或者顶层内部总线。

模块中的每个输出信号原则上必须通过寄存器输出。任何不通过寄存器输出的信号必须加以注释，注意防止出现反馈回路。

尽量合并源代码，使其简洁明了，不要试图依靠综合器的功能。

case语句和if-else语句必须保证其完整性，即所有分支项应该完全列出，case语句应该加缺省项(default)，if语句应该有对应的else项。

使用参数(parameter)作为可变化的常数，例如总线的位宽。

端口声明的顺序在保证先输入再输出的基础上按如下顺序 clocks, resets, control signals, address bus, data bus

端口和连接端口的信号尽量同名。

## 命名规则

### 常用规则:

常数、DEFINE和参数必须用大写字母定义

应用下横线来表示词间隔

所有端口、信号、变量均采用小写

输入输出端口和信号的声明必须每个信号一行，然后组合起来

### 信号命名规则:

时钟信号用clk做前缀

复位信号用reset做前缀

单个输入信号用i做前缀

总线输入信号用iv做前缀

单个输出信号用o做前缀

总线输出信号用ov做前缀

单条线网用w做前缀

线网总线用wv做前缀

### 文件命名

每文件最多只能包含一个模块，在一个文件中不允许编写一个以上的模块。

该模块的测试文件必须用另外一个文件表示，因此一个经过初步验证的模块必须用一个包含可综合模块和测试文件的文件夹来表示。

### 文件命名方式

文件名必须以下列方式构成:<设计单元名>:<文件类型>。<扩展名>。

其中，<设计单元名>是设计的单元名。

文件类型>标明文件类型(可选)

_ task文件由任务构成

_ func文件由函数构成

_ parameter文件由参数构成

_ defines文件由宏文本构成

_ disc文件是规则文件

_ connect文件是连接规则和连接模块文件

<ext>表示是Verilog文件，.v是 verilog文件，va是 verilog-AMS文件

### 模块命名

模块命名采用大写缩写，命名要必须与文件名字完全一致。

模块之间接口信号的所有变量命名分为两个部分

第一部分表明数据方向，其中数据发出方在前，数据接收方在后，

第二部分为数据名称。两部分之间用下划线隔离开。

第一部分全部大写，第二部分所有具有明确意义的英文名全部拼写或缩写的第一个字母大写，其余部分小写。

举例wire CPUMMU_WrReq。

### 表示常量的命名必须大写

表示常量的命名必须全由大写字母组成。这里常量是指:参数名和宏名。

### 线网名,变量名,结构名和对象名必须都用小写字母表示

与电路结构有密切关系的硬件结构名必须全部都用小写字母表示。

这包括:线网名、变量名、结构名(如 functions, tasks,命名的块、模块、或是用户原语)和对象名(如门级电路、模块等)。

### 后缀的命名

对低电平有效信号进行命名时,必须使用“n”作为名字的后缀

时钟信号的名字中若没有“ clock或者clk”时,则必须使用后缀“clk”为该时钟信号命名。

未连接的输出信号以“nc”结尾0三态信号名以“z“结尾

建议三态信号名以“z“结尾

### 注释命名

功能、参数、输入参数 、输出参数、主要思路、日期、程序编写人员、程序调试记录、调用方法

在注释中应该详细说明模块的主要实现思路，特别要注明自己的一些想法，如果有必要则应该写明对想法产生的来由。 

在注释中详细注明函数的适用方法，对于输入参数的要求以及输出数据的格式。 

在注释中要强调调用时的危险方面，可能出错的地方
